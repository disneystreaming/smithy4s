<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-overview/sharing-specs">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Sharing specifications | smithy4s</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://disneystreaming.github.io/smithy4s/docs/overview/sharing-specs"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Sharing specifications | smithy4s"><meta data-rh="true" name="description" content="The core Smithy tooling built by AWS makes it easy to load Smithy files that are packaged in jars. Smithy4s makes use of this feature to allow users"><meta data-rh="true" property="og:description" content="The core Smithy tooling built by AWS makes it easy to load Smithy files that are packaged in jars. Smithy4s makes use of this feature to allow users"><link data-rh="true" rel="icon" href="/smithy4s/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://disneystreaming.github.io/smithy4s/docs/overview/sharing-specs"><link data-rh="true" rel="alternate" href="https://disneystreaming.github.io/smithy4s/docs/overview/sharing-specs" hreflang="en"><link data-rh="true" rel="alternate" href="https://disneystreaming.github.io/smithy4s/docs/overview/sharing-specs" hreflang="x-default"><link rel="stylesheet" href="/smithy4s/assets/css/styles.0cf009d5.css">
<link rel="preload" href="/smithy4s/assets/js/runtime~main.3a4b0591.js" as="script">
<link rel="preload" href="/smithy4s/assets/js/main.0aadda18.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/smithy4s/"><div class="navbar__logo"><img src="/smithy4s/img/logo.svg" alt="Disney Streaming Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/smithy4s/img/logoDark.svg" alt="Disney Streaming Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">smithy4s</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/smithy4s/docs/overview/intro">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/disneystreaming/smithy4s" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.gg/wvVga94s8r" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/smithy4s/docs/overview/intro">Overview</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/smithy4s/docs/overview/intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/smithy4s/docs/overview/quickstart">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/smithy4s/docs/overview/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/smithy4s/docs/overview/cli">Installation (CLI)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/smithy4s/docs/overview/sharing-specs">Sharing specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/smithy4s/docs/overview/stubs">Stubbed implementations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/smithy4s/docs/the-smithy-idl/smithy-idl">The Smithy IDL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/smithy4s/docs/protocols/protocols">Protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/smithy4s/docs/codegen/customisation/packed-inputs">Code generation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/smithy4s/docs/design/design">Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/smithy4s/docs/guides/endpoint-middleware">Guides</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/smithy4s/docs/credits">Credits</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/smithy4s/docs/known-issues">Known Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/smithy4s/docs/learning-resources">Learning resources</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/smithy4s/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Overview</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Sharing specifications</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Sharing specifications</h1></header><p>The core Smithy tooling built by AWS makes it easy to load Smithy files that are packaged in jars. Smithy4s makes use of this feature to allow users
to generate code from specs that may be found in Maven Central or other artifact repository.</p><h1>Packaging specifications in order to share them</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scala-agnostic-context">Scala-agnostic context<a href="#scala-agnostic-context" class="hash-link" aria-label="Direct link to Scala-agnostic context" title="Direct link to Scala-agnostic context">​</a></h2><p>If you work in a context that is not primordially Scala-centric, you may want to package Smithy specification in Jars to make them easily accessible to various
code-generator tools. When that is the case, it is not-advised to use Smithy4s in order to package specifications, as the consuming applications/tools might not
have awareness of Scala. The best practice would likely be to have jars that would contain only Smithy files and potentially pure-java custom validators.</p><p>In order to package Smithy files in jars so that they can be easily consumed by tools, here are the core details:</p><ol><li>All smithy files should be stored under <code>src/main/resources/META-INF/smithy/</code> (or in another resource directory, under <code>META-INF/smithy</code>)</li><li>A <code>manifest</code> file should be stored under that same directory</li><li>The <code>manifest</code> file should reference all the smithy files that can be found in that <code>META-INF/smithy</code> directory.</li><li>If you are using SBT to do this, consider setting <code>autoScalaLibrary := false</code>. See <a href="https://www.scala-sbt.org/1.x/docs/Configuring-Scala.html#Configuring+the+scala-library+dependency" target="_blank" rel="noopener noreferrer">here</a> for more information.</li><li>If you are using Mill to do this, consider using a <code>JavaModule</code> instead of a <code>ScalaModule</code>.</li></ol><p>A couple examples:</p><ul><li><a href="https://github.com/awslabs/smithy/tree/main/smithy-aws-apigateway-traits/src/main/resources/META-INF/smithy" target="_blank" rel="noopener noreferrer">smithy-aws-apigateway-traits</a></li><li><a href="https://github.com/disneystreaming/smithy4s/blob/7a60eb7daaaa0e1a75d8e13c4eb65fcff9c2b669/modules/protocol/resources/META-INF/smithy" target="_blank" rel="noopener noreferrer">smithy4s-protocols</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smithy4s-context">Smithy4s-context<a href="#smithy4s-context" class="hash-link" aria-label="Direct link to Smithy4s-context" title="Direct link to Smithy4s-context">​</a></h2><p>The Smithy4s build-plugins we provide out of the box automatically package the local specifications (used for code-generations) in the resulting jars so that downstream projects (internal and external) can use them. When doing so, Smithy4s abides by the same structure described above.</p><p>Additionally, Smithy4s will also produce a smithy file containing a piece of metadata listing the namespaces for which code was generated. This way, downstream Smithy4s calls can automatically skip the already-generated namespaces.</p><p>This does mean two things:</p><ol><li>Users do not have to manually indicate namespaces that were already generated.</li><li>When using multi-module builds, Smithy specifications in one module can depend on Smithy specifications in another module it depends on, without the user having to do anything bespoke for it. The resulting Scala code in the downstream module will simply depend on the one in the upstream module, as if it had been handwritten.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-packaging-of-smithy-files-in-jars">Disabling packaging of smithy files in jars<a href="#disabling-packaging-of-smithy-files-in-jars" class="hash-link" aria-label="Direct link to Disabling packaging of smithy files in jars" title="Direct link to Disabling packaging of smithy files in jars">​</a></h3><p>If for some reason you want to disable the packaging of Smithy files in the jars created by your build tool, follow the instructions below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sbt">SBT<a href="#sbt" class="hash-link" aria-label="Direct link to SBT" title="Direct link to SBT">​</a></h4><p>Add the following setting to your project</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Compile </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> smithy4sSmithyLibrary </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mill">Mill<a href="#mill" class="hash-link" aria-label="Direct link to Mill" title="Direct link to Mill">​</a></h4><p>Override the following method in your module</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">override</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> smithy4sSmithyLibrary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-the-dependency-on-smithy-files-in-sibling-projects">Disabling the dependency on smithy files in sibling projects<a href="#disabling-the-dependency-on-smithy-files-in-sibling-projects" class="hash-link" aria-label="Direct link to Disabling the dependency on smithy files in sibling projects" title="Direct link to Disabling the dependency on smithy files in sibling projects">​</a></h3><p>If your project has a multi-module build and some of the modules have the plugin enabled,
due to the behavior documented above, dependencies will need to be compiled before code can be generated.</p><p>Consider the following build (sbt syntax):</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> project</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enablePlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Smithy4sCodegenPlugin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dependsOn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Whenever you want to generate the Scala code in project <code>b</code>, your build tool will trigger compilation of <code>a</code>. This happens so that the Smithy files in the <code>a</code> project get packaged into a JAR file - just like they normally are when you package the <code>a</code> project otherwise (for <code>publishLocal</code>, <code>stage</code> etc.).</p><p>You can opt out of this behavior:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sbt-1">SBT<a href="#sbt-1" class="hash-link" aria-label="Direct link to SBT" title="Direct link to SBT">​</a></h4><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> project</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">settings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Compile </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> smithy4sInternalDependenciesAsJars </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">//...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mill-1">Mill<a href="#mill-1" class="hash-link" aria-label="Direct link to Mill" title="Direct link to Mill">​</a></h4><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">object</span><span class="token plain"> b </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> Smithy4sModule </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">override</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> smithy4sInternalDependenciesAsJars </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">empty</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">PathRef</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will not only remove the need for compilation (for the purposes of codegen), but also remove any visibility of the Smithy files in the <strong>local</strong> dependencies of your project (<strong>local</strong> meaning they&#x27;re defined in the same build).</p><p>You can use the same setting, <code>smithy4sInternalDependenciesAsJars</code>, to add additional JARs containing Smithy specs - just keep in mind that remote dependencies (<code>libraryDependencies</code>) are added automatically!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-word-of-warning">A word of warning<a href="#a-word-of-warning" class="hash-link" aria-label="Direct link to A word of warning" title="Direct link to A word of warning">​</a></h3><p>Smithy4s optimises for &quot;correctness&quot; as opposed to &quot;compatibility.&quot; This means the generated Scala code aims at 1) being an accurate reflection of the Smithy models and 2) providing an idiomatic developer experience. This happens at the cost of a lack of guarantees around the binary compatibility of the generated code when the Schema evolves.</p><p>When packaging Smithy specs in artifacts that contain Smithy4s-generated code, developers should keep that aspect in mind, and ensure that the version of Smithy4s that produced upstream artifacts is binary-compatible with the version that they use locally. Tools such as MiMa can help</p><p>We cannot recommend treating Smithy4s-generated code as publishable library-material. Should you decide to do so, please exercise caution.</p><h1>Depending on shared specifications</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="artifacts-containing-only-specifications">Artifacts containing only specifications<a href="#artifacts-containing-only-specifications" class="hash-link" aria-label="Direct link to Artifacts containing only specifications" title="Direct link to Artifacts containing only specifications">​</a></h2><p>For instance, AWS publishes a number of <a href="https://github.com/awslabs/smithy/tree/main/smithy-aws-apigateway-traits/src/main/resources/META-INF/smithy" target="_blank" rel="noopener noreferrer">api-gateway specific traits</a> to <a href="https://search.maven.org/artifact/software.amazon.smithy/smithy-aws-apigateway-traits" target="_blank" rel="noopener noreferrer">Maven central</a> (the shapes are defined there in a smithy-compliant Json file).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sbt-2">SBT<a href="#sbt-2" class="hash-link" aria-label="Direct link to SBT" title="Direct link to SBT">​</a></h2><p>Using the SBT plugin, the <code>Smithy4s</code> config object can be used to tag dependencies that Smithy4s should feed to the code generator.</p><p>You can declare your intent to depend on these smithy definitions as such:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libraryDependencies </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;software.amazon.smithy&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;smithy-aws-iam-traits&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.14.1&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> Smithy4s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mill-2">Mill<a href="#mill-2" class="hash-link" aria-label="Direct link to Mill" title="Direct link to Mill">​</a></h2><p>Mill uses a separate task to define dependencies that the code-generator should have awareness of:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> smithy4sIvyDeps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation id function" style="color:#d73a49">ivy</span><span class="token string-interpolation string" style="color:#e3116c">&quot;software.amazon.smithy::smithy-aws-iam-traits:1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consequence">Consequence<a href="#consequence" class="hash-link" aria-label="Direct link to Consequence" title="Direct link to Consequence">​</a></h2><p>This will have the effect of loading the contents of the smithy files (or smithy-compliant Json files) from the artifact into the aggregated model that Smithy4s uses as an input to the code generator. It means that the traits and shapes defined in these files will be available to use in your models, but it also means that Smithy4s will try to generate code for these shapes.</p><p>This artifact will not be included as a dependency to your project at compile-time (nor runtime), it will only be consumed for the
Smithy specs (and validators) it may contain.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="artifacts-containing-both-smithy-files-and-smithy4s-generated-code">Artifacts containing both Smithy files and Smithy4s generated code<a href="#artifacts-containing-both-smithy-files-and-smithy4s-generated-code" class="hash-link" aria-label="Direct link to Artifacts containing both Smithy files and Smithy4s generated code" title="Direct link to Artifacts containing both Smithy files and Smithy4s generated code">​</a></h2><p>When using Smithy4s, you may want to depend on artifacts that may have been built using Smithy4s, containing both Smithy specifications
and generated Scala code (or rather, JVM bytecode resulting from the compilation of generated Scala code). In this case, you don&#x27;t have to
do anything particular, the simple fact of declaring a library dependency will result in the smithy files contained by that dependency to be
used during the &quot;compilation&quot; of your smithy specs during the code-generation process.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sbt-3">SBT<a href="#sbt-3" class="hash-link" aria-label="Direct link to SBT" title="Direct link to SBT">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">libraryDependencies </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;organisation&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;artifact&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mill-3">Mill<a href="#mill-3" class="hash-link" aria-label="Direct link to Mill" title="Direct link to Mill">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> ivyDeps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation id function" style="color:#d73a49">ivy</span><span class="token string-interpolation string" style="color:#e3116c">&quot;organisation:artifact:version&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consequence-1">Consequence<a href="#consequence-1" class="hash-link" aria-label="Direct link to Consequence" title="Direct link to Consequence">​</a></h3><p>Because the upstream usage of Smithy4s will have resulted in the creation of metadata tracking the namespaces that were already generated, the &quot;local&quot; Smithy4s code-generation will automatically skip the generation of code that should not be generated again.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="artifacts-containing-smithy4s-generated-code-dependency-tracking">Artifacts containing Smithy4s generated code: dependency tracking<a href="#artifacts-containing-smithy4s-generated-code-dependency-tracking" class="hash-link" aria-label="Direct link to Artifacts containing Smithy4s generated code: dependency tracking" title="Direct link to Artifacts containing Smithy4s generated code: dependency tracking">​</a></h2><p>When packaging a project/module via SBT or Mill, Smithy4s adds a line to the Jar manifest of the project, informing downstream projects of library dependencies that may have been used during the code-generation of this project/module (ie, the dependencies annotated with <code>% Smithy4s</code> in SBT, and the ones provided by
<code>smithy4sIvyDeps</code> in mill).</p><p>This information is used automatically by downstream projects using Smithy4s, which automatically pulls additional jars that would be specified
in this bit of metadata.</p><p>So, for instance, if you have</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">lazy</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> upstream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">project in file</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enablePlugins</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Smithy4sCodegenPlugin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">settings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    organization </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foobar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libraryDependencies </span><span class="token operator" style="color:#393A34">++</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;software.amazon.smithy&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;smithy-aws-iam-traits&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.14.1&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> Smithy4s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and publish this project to an artifact repository, the Jar manifest will contain a line with the relevant
dependencies (comma separated if there are more than one) :</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">smithy4sDependencies: software.amazon.smithy:smithy-aws-iam-traits:1.14.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using this artifact in a downstream project, for instance with :</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">lazy</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> downstream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">project in file</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enablePlugins</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Smithy4sCodegenPlugin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">settings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libraryDependencies </span><span class="token operator" style="color:#393A34">++</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// compile/runtime dependency that contains Smithy4s-generated code but doesn&#x27;t contain smithy files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;foobar&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;upstream&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will result in the <code>&quot;software.amazon.smithy&quot; % &quot;smithy-aws-iam-traits&quot; % &quot;1.14.1&quot;</code> dependency being automatically fetched
and used for the smithy-level classpath of the smithy files contained by <code>downstream</code>. This effectively means that smithy files
in <code>downstream</code> can use the Smithy shapes present in the <code>smithy-aws-iam-traits</code> artifact.</p><p>One side-effect of this is that if you produce JARs containing artifacts produced by Smithy4s code generation, they&#x27;ll contain some common files with other smithy projects, particularly within the <code>META-INF</code> folder. You&#x27;ll need to write a custom <code>assemblyMergeStrategy</code>, like so:</p><div class="language-sbt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sbt codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">assemblyMergeStrategy := {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case PathList(&quot;META-INF&quot;, xs @ _*) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xs.map(_.toLowerCase) match {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // http4s-swagger provides the swagger webjar, which can conflict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case &quot;resources&quot; :: &quot;webjars&quot; :: xs               =&gt; MergeStrategy.first</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // There is no harm in removing the tracking file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case &quot;smithy&quot; :: &quot;smithy4s.tracking.smithy&quot;       =&gt; MergeStrategy.discard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Keep the correct smithy manifest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case &quot;smithy&quot; :: &quot;manifest&quot;                       =&gt; MergeStrategy.first</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Discard the rest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case _                                            =&gt; MergeStrategy.discard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case x =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val oldStrategy = assemblyMergeStrategy.value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    oldStrategy(x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is perfectly fine to discard this file from your assembly jar.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manually-skipping-or-including-namespaces-during-code-generation">Manually skipping (or including) namespaces during code-generation.<a href="#manually-skipping-or-including-namespaces-during-code-generation" class="hash-link" aria-label="Direct link to Manually skipping (or including) namespaces during code-generation." title="Direct link to Manually skipping (or including) namespaces during code-generation.">​</a></h3><p>Sometimes, you may want to tell Smithy4s to skip code-generation of some namespaces altogether, because the corresponding code may have been produced by another tool than Smithy4s. In that case, you can gain control over which namespaces Smithy4s crawls through when performing the code generation to avoid regenerating code that already exists. This is achieved via a couple of build-settings (the names are shared between SBT and Mill).</p><ul><li><code>smithy4sAllowedNamespaces</code> which is an allow-list</li><li><code>smithy4sExcludedNamespaces</code> which is a disallow-list</li></ul><p>By default, Smithy4s tries to generate everything but shapes that are in the following namespaces:</p><ul><li><code>smithy4s.api</code></li><li><code>smithy4s.meta</code></li><li><code>alloy</code></li><li>namespaces that start with <code>aws</code></li><li>namespaces that start with <code>smithy</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="note-regarding-credentials">Note regarding credentials<a href="#note-regarding-credentials" class="hash-link" aria-label="Direct link to Note regarding credentials" title="Direct link to Note regarding credentials">​</a></h3><p>The SBT plugin provided by Smithy4s uses SBT&#x27;s resolution mechanism (based on coursier) to retrieve the artifacts from their respective repositories. This implies that the resolvers-related settings are respected, included credentials that may be needed to read from some private artifact repository.</p><p>In the CLI, the <a href="https://get-coursier.io/docs/2.0.0-RC4-1/other-credentials#docsNav" target="_blank" rel="noopener noreferrer">mechanisms native to coursier</a> are respected.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/disneystreaming/smithy4s/edit/main/modules/docs/src/01-overview/05-sharing-specs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/smithy4s/docs/overview/cli"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installation (CLI)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/smithy4s/docs/overview/stubs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stubbed implementations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scala-agnostic-context" class="table-of-contents__link toc-highlight">Scala-agnostic context</a></li><li><a href="#smithy4s-context" class="table-of-contents__link toc-highlight">Smithy4s-context</a><ul><li><a href="#disabling-packaging-of-smithy-files-in-jars" class="table-of-contents__link toc-highlight">Disabling packaging of smithy files in jars</a></li><li><a href="#disabling-the-dependency-on-smithy-files-in-sibling-projects" class="table-of-contents__link toc-highlight">Disabling the dependency on smithy files in sibling projects</a></li><li><a href="#a-word-of-warning" class="table-of-contents__link toc-highlight">A word of warning</a></li></ul></li><li><a href="#artifacts-containing-only-specifications" class="table-of-contents__link toc-highlight">Artifacts containing only specifications</a></li><li><a href="#sbt-2" class="table-of-contents__link toc-highlight">SBT</a></li><li><a href="#mill-2" class="table-of-contents__link toc-highlight">Mill</a></li><li><a href="#consequence" class="table-of-contents__link toc-highlight">Consequence</a></li><li><a href="#artifacts-containing-both-smithy-files-and-smithy4s-generated-code" class="table-of-contents__link toc-highlight">Artifacts containing both Smithy files and Smithy4s generated code</a><ul><li><a href="#sbt-3" class="table-of-contents__link toc-highlight">SBT</a></li><li><a href="#mill-3" class="table-of-contents__link toc-highlight">Mill</a></li><li><a href="#consequence-1" class="table-of-contents__link toc-highlight">Consequence</a></li></ul></li><li><a href="#artifacts-containing-smithy4s-generated-code-dependency-tracking" class="table-of-contents__link toc-highlight">Artifacts containing Smithy4s generated code: dependency tracking</a><ul><li><a href="#manually-skipping-or-including-namespaces-during-code-generation" class="table-of-contents__link toc-highlight">Manually skipping (or including) namespaces during code-generation.</a></li><li><a href="#note-regarding-credentials" class="table-of-contents__link toc-highlight">Note regarding credentials</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/smithy4s/docs/overview/intro">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/disneystreaming/smithy4s" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Special thanks</div><ul class="footer__items clean-list"><li class="footer__item">
                    <a href="https://www.yourkit.com/" target="_blank" rel="noreferrer noopener" aria-label="Profiled with yourkit">
                      <img src="https://www.yourkit.com/images/yk_logo.svg" alt="Profiled with yourkit">
                    </a>
                  </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Disney Streaming</div></div></div></footer></div>
<script src="/smithy4s/assets/js/runtime~main.3a4b0591.js"></script>
<script src="/smithy4s/assets/js/main.0aadda18.js"></script>
</body>
</html>