"use strict";(self.webpackChunksmithy4s=self.webpackChunksmithy4s||[]).push([[3715],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>f});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(r),u=i,f=d["".concat(l,".").concat(u)]||d[u]||m[u]||o;return r?n.createElement(f,a(a({ref:t},p),{},{components:r})):n.createElement(f,a({ref:t},p))}));function f(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},5834:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=r(7462),i=(r(7294),r(3905));const o={sidebar_label:"Middlewares",title:"Middlewares"},a=void 0,s={unversionedId:"protocols/aws/middleware",id:"protocols/aws/middleware",title:"Middlewares",description:"It is not the purpose of Smithy4s to reach feature-parity with the official Java SDK, in particular when it comes to retry policies and metrics. However, it's important for Smithy4s to empower users to wire custom behaviour in the AWS clients it provides.",source:"@site/../docs/target/jvm-2.13/mdoc/03-protocols/03-aws/03-middleware.md",sourceDirName:"03-protocols/03-aws",slug:"/protocols/aws/middleware",permalink:"/smithy4s/docs/protocols/aws/middleware",draft:!1,editUrl:"https://github.com/disneystreaming/smithy4s/edit/main/modules/docs/src/03-protocols/03-aws/03-middleware.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_label:"Middlewares",title:"Middlewares"},sidebar:"tutorialSidebar",previous:{title:"Localstack",permalink:"/smithy4s/docs/protocols/aws/localstack"},next:{title:"SimpleRestJson",permalink:"/smithy4s/docs/protocols/simple-rest-json/overview"}},l={},c=[],p={toc:c},d="wrapper";function m(e){let{components:t,...r}=e;return(0,i.kt)(d,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"It is not the purpose of Smithy4s to reach feature-parity with the official Java SDK, in particular when it comes to retry policies and metrics. However, it's important for Smithy4s to empower users to wire custom behaviour in the AWS clients it provides."),(0,i.kt)("p",null,"To that end, Smithy4s provides a middleware mechanism :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-scala"},'import smithy4s._\nimport smithy4s.aws._\nimport cats.effect._\nimport cats.syntax.all._\nimport org.http4s.client._\n\ndef http4sClient : Client[IO] = ???\n\nobject PrintingMiddleware extends Endpoint.Middleware.Standard[Client[IO]] {\n  def prepare(serviceId: ShapeId, endpointId: ShapeId, serviceHints: Hints, endpointHints: Hints): Client[IO] => Client[IO] =\n      underlyingClient => Client { req =>\n        IO.println(s"Calling ${serviceId.name}.${endpointId.name}").toResource *>\n        underlyingClient.run(req)\n      }\n}\n\nval awsEnvironment = AwsEnvironment.default(http4sClient, AwsRegion.US_EAST_1).map(_.withMiddleware(PrintingMiddleware))\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Endpoint.Middleware")," interface allows to provide transformations that will be applied on per-endpoint basis, allowing to customise\nthe behaviour of the client based on the calls that are made to AWS."))}m.isMDXComponent=!0}}]);